// This code is an assortment of math functions that I wrote myself.
// It contains two classes and several helper functions. It also contains
// functions that generate rotational matrices and a Sine and Cosine function
// that utilize a lookup table to quickly generate results.


#ifndef MATH_TOOLS
#define MATH_TOOLS

// vector declaration--------------------------------------------------------------------------------
class matrix3x3;

class vector
{
public:

	vector(); // sets x = 0, y = 0, and z = 0
	vector(const double &x_); // sets = x = x_, y = y_, and z = z_
	vector(const double &x_, const double &y_, const double &z_); // sets x = x_, y = y_, and z = z_
	
	double x, y, z;

	vector operator = (const double &x) const; // returns (i + j + k) * x

	double operator * (const vector &v) const; // returns the dot product
	
	vector operator * (const double &c) const; // returns the vector times the scalar
	vector operator / (const double &c) const; // returns the vector divided by the scalar

	operator *= (const double &c); // multiples the vector by the scalar
	operator /= (const double &c); // divides the vector by the scalar
	operator *= (const matrix3x3 &M); // returns the matrix times the vector (Note: the matrix is in front of the vector and not behind it).
		
	vector operator + (const vector &v) const; // returns the sum of two vectors
	vector operator - (const vector &v) const; // returns the difference of two vectors

	operator += (const vector &v); // increments the object by vector v
	operator -= (const vector &v); // decrements the object by vector v

	vector operator ^ (const vector &v) const; // returns the cross product of the two vectors
};

double Magnitude(const vector &v); // returns the magnitude of the vector
vector Hat(vector v); // scales the vector v until it is a unit vector

vector operator * (const double &c, const vector &v); // returns the scalar times the vector


// matrix declaration-------------------------------------------------------------------------------
class matrix3x3
{
public:

	matrix3x3(); // sets all elements to zero
	matrix3x3(const double &e11_, const double &e12_, const double &e13_,
		      const double &e21_, const double &e22_, const double &e23_,
			  const double &e31_, const double &e32_, const double &e33_);

	double e11, e12, e13,
		   e21, e22, e23,
		   e31, e32, e33;

	matrix3x3 operator * (const matrix3x3 &X) const; // returns two 3x3 matrices multiplied together
	
	matrix3x3 operator * (const double &c) const; // returns the matrix times a scalar
	matrix3x3 operator / (const double &c) const; // returns the matrix divided by a scalar

	operator *= (const double &c); // multiplies the matrix by a scalar
	operator /= (const double &c); // divides the matrix by a scalar

	matrix3x3 operator + (const matrix3x3 &X) const; // returns the sum of two matrices
	matrix3x3 operator - (const matrix3x3 &X) const; // returns the difference of two matrices

	operator += (const matrix3x3 &X); // returns the sum of two matrices
	operator -= (const matrix3x3 &X); // returns the difference of two matrices
};

double Det(const matrix3x3 &X); // returns the determinant of a 3x3 matrix
matrix3x3 Inverse(const matrix3x3 &X); // returns the inverse of a matrix 

matrix3x3 operator * (const double &c, const matrix3x3 &X); // multiplies the matrix by a scalar
vector operator * (const matrix3x3 &X, const vector &v); // multiplies a matrix by a vector
vector operator * (const vector &v, const matrix3x3 &X); // multiplies a matrix by a vector


// assorted math function declarations---------------------------------------------------
double Absolute(double x); // Returns the absolute value.
double Maximum(double x, double y); // If y is greater than x, the function returns y. Otherwise, it returns x.
double Sign(double x); // returns -1.0 if x < 0 or else it returns 1.0

double Sine(double x); // refers to sinTable to computer sin(x)
double Cosine(double x); // refers to the above function to computer cos(x)

matrix3x3 R_x(double o); // rotational matrix that rotates a vector clockwise around the x-axis
matrix3x3 R_y(double o); // rotational matrix that rotates a vector clockwise around the y-axis
matrix3x3 R_z(double o); // rotational matrix that rotates a vector clockwise around the z-axis

matrix3x3 R_v(double o, vector v); // rotation matrix that rotates a vector around the paramter v


// constants and defines--------------------------------------------------------------------------
#define i vector(1.0, 0.0, 0.0) // these symbols will let us write out vectors in the form of x * i + y * k + z * k 
#define j vector(0.0, 1.0, 0.0)
#define k vector(0.0, 0.0, 1.0)

#define I matrix3x3(1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0)

#define PI 3.1415926535897932384626433832795

// I wrote computer program to generate this massive sin table.
// So I wrote a computer program to write code for this computer
// progam!
#define SIZE_OF_SIN_TABLE 500
const double sinTable[] = {
                           0.001571,
                           0.004712,
                           0.007854,
                           0.010995,
                           0.014137,
                           0.017278,
                           0.020419,
                           0.023560,
                           0.026700,
                           0.029841,
                           0.032981,
                           0.036120,
                           0.039260,
                           0.042399,
                           0.045537,
                           0.048675,
                           0.051813,
                           0.054950,
                           0.058087,
                           0.061223,
                           0.064358,
                           0.067493,
                           0.070627,
                           0.073760,
                           0.076893,
                           0.080025,
                           0.083156,
                           0.086286,
                           0.089416,
                           0.092544,
                           0.095672,
                           0.098799,
                           0.101924,
                           0.105049,
                           0.108173,
                           0.111295,
                           0.114417,
                           0.117537,
                           0.120657,
                           0.123775,
                           0.126891,
                           0.130007,
                           0.133121,
                           0.136234,
                           0.139346,
                           0.142456,
                           0.145565,
                           0.148672,
                           0.151778,
                           0.154883,
                           0.157986,
                           0.161087,
                           0.164187,
                           0.167285,
                           0.170381,
                           0.173476,
                           0.176569,
                           0.179661,
                           0.182750,
                           0.185838,
                           0.188924,
                           0.192008,
                           0.195090,
                           0.198171,
                           0.201249,
                           0.204325,
                           0.207400,
                           0.210472,
                           0.213542,
                           0.216610,
                           0.219676,
                           0.222740,
                           0.225801,
                           0.228861,
                           0.231918,
                           0.234972,
                           0.238025,
                           0.241075,
                           0.244123,
                           0.247168,
                           0.250211,
                           0.253251,
                           0.256289,
                           0.259325,
                           0.262358,
                           0.265388,
                           0.268415,
                           0.271440,
                           0.274463,
                           0.277482,
                           0.280499,
                           0.283513,
                           0.286525,
                           0.289533,
                           0.292539,
                           0.295541,
                           0.298541,
                           0.301538,
                           0.304532,
                           0.307523,
                           0.310511,
                           0.313495,
                           0.316477,
                           0.319456,
                           0.322431,
                           0.325403,
                           0.328372,
                           0.331338,
                           0.334300,
                           0.337260,
                           0.340215,
                           0.343168,
                           0.346117,
                           0.349063,
                           0.352005,
                           0.354944,
                           0.357879,
                           0.360811,
                           0.363739,
                           0.366664,
                           0.369585,
                           0.372502,
                           0.375416,
                           0.378326,
                           0.381232,
                           0.384134,
                           0.387033,
                           0.389928,
                           0.392819,
                           0.395706,
                           0.398589,
                           0.401468,
                           0.404344,
                           0.407215,
                           0.410082,
                           0.412945,
                           0.415805,
                           0.418660,
                           0.421511,
                           0.424357,
                           0.427200,
                           0.430038,
                           0.432873,
                           0.435702,
                           0.438528,
                           0.441349,
                           0.444166,
                           0.446979,
                           0.449787,
                           0.452590,
                           0.455390,
                           0.458184,
                           0.460974,
                           0.463760,
                           0.466541,
                           0.469317,
                           0.472089,
                           0.474856,
                           0.477619,
                           0.480377,
                           0.483130,
                           0.485878,
                           0.488621,
                           0.491360,
                           0.494094,
                           0.496822,
                           0.499546,
                           0.502266,
                           0.504980,
                           0.507689,
                           0.510393,
                           0.513092,
                           0.515786,
                           0.518475,
                           0.521159,
                           0.523837,
                           0.526511,
                           0.529179,
                           0.531842,
                           0.534500,
                           0.537152,
                           0.539800,
                           0.542442,
                           0.545078,
                           0.547709,
                           0.550335,
                           0.552955,
                           0.555570,
                           0.558180,
                           0.560784,
                           0.563382,
                           0.565975,
                           0.568562,
                           0.571143,
                           0.573719,
                           0.576290,
                           0.578854,
                           0.581413,
                           0.583966,
                           0.586514,
                           0.589055,
                           0.591591,
                           0.594121,
                           0.596645,
                           0.599163,
                           0.601676,
                           0.604182,
                           0.606682,
                           0.609177,
                           0.611665,
                           0.614147,
                           0.616624,
                           0.619094,
                           0.621558,
                           0.624016,
                           0.626468,
                           0.628913,
                           0.631353,
                           0.633786,
                           0.636213,
                           0.638634,
                           0.641048,
                           0.643456,
                           0.645858,
                           0.648253,
                           0.650642,
                           0.653024,
                           0.655400,
                           0.657770,
                           0.660133,
                           0.662489,
                           0.664839,
                           0.667183,
                           0.669520,
                           0.671850,
                           0.674173,
                           0.676490,
                           0.678801,
                           0.681104,
                           0.683401,
                           0.685691,
                           0.687975,
                           0.690251,
                           0.692521,
                           0.694784,
                           0.697040,
                           0.699289,
                           0.701531,
                           0.703767,
                           0.705995,
                           0.708217,
                           0.710431,
                           0.712639,
                           0.714839,
                           0.717032,
                           0.719219,
                           0.721398,
                           0.723570,
                           0.725735,
                           0.727892,
                           0.730043,
                           0.732186,
                           0.734323,
                           0.736451,
                           0.738573,
                           0.740687,
                           0.742794,
                           0.744894,
                           0.746986,
                           0.749071,
                           0.751149,
                           0.753219,
                           0.755282,
                           0.757337,
                           0.759385,
                           0.761425,
                           0.763458,
                           0.765483,
                           0.767501,
                           0.769511,
                           0.771514,
                           0.773508,
                           0.775496,
                           0.777475,
                           0.779447,
                           0.781412,
                           0.783368,
                           0.785317,
                           0.787258,
                           0.789191,
                           0.791117,
                           0.793034,
                           0.794944,
                           0.796846,
                           0.798741,
                           0.800627,
                           0.802505,
                           0.804376,
                           0.806238,
                           0.808093,
                           0.809939,
                           0.811778,
                           0.813608,
                           0.815431,
                           0.817245,
                           0.819052,
                           0.820850,
                           0.822641,
                           0.824423,
                           0.826197,
                           0.827962,
                           0.829720,
                           0.831470,
                           0.833211,
                           0.834944,
                           0.836669,
                           0.838385,
                           0.840094,
                           0.841794,
                           0.843485,
                           0.845169,
                           0.846844,
                           0.848510,
                           0.850168,
                           0.851818,
                           0.853460,
                           0.855093,
                           0.856718,
                           0.858334,
                           0.859941,
                           0.861541,
                           0.863131,
                           0.864713,
                           0.866287,
                           0.867852,
                           0.869409,
                           0.870957,
                           0.872496,
                           0.874027,
                           0.875549,
                           0.877062,
                           0.878567,
                           0.880063,
                           0.881551,
                           0.883030,
                           0.884500,
                           0.885961,
                           0.887413,
                           0.888857,
                           0.890292,
                           0.891719,
                           0.893136,
                           0.894545,
                           0.895944,
                           0.897335,
                           0.898718,
                           0.900091,
                           0.901455,
                           0.902811,
                           0.904157,
                           0.905495,
                           0.906823,
                           0.908143,
                           0.909454,
                           0.910756,
                           0.912049,
                           0.913332,
                           0.914607,
                           0.915873,
                           0.917130,
                           0.918377,
                           0.919616,
                           0.920845,
                           0.922066,
                           0.923277,
                           0.924480,
                           0.925673,
                           0.926857,
                           0.928031,
                           0.929197,
                           0.930354,
                           0.931501,
                           0.932639,
                           0.933768,
                           0.934888,
                           0.935998,
                           0.937099,
                           0.938191,
                           0.939274,
                           0.940348,
                           0.941412,
                           0.942467,
                           0.943512,
                           0.944548,
                           0.945575,
                           0.946593,
                           0.947601,
                           0.948600,
                           0.949590,
                           0.950570,
                           0.951541,
                           0.952502,
                           0.953454,
                           0.954397,
                           0.955330,
                           0.956254,
                           0.957168,
                           0.958073,
                           0.958968,
                           0.959854,
                           0.960731,
                           0.961598,
                           0.962455,
                           0.963303,
                           0.964142,
                           0.964971,
                           0.965790,
                           0.966600,
                           0.967400,
                           0.968191,
                           0.968973,
                           0.969744,
                           0.970506,
                           0.971259,
                           0.972002,
                           0.972735,
                           0.973459,
                           0.974173,
                           0.974878,
                           0.975573,
                           0.976258,
                           0.976934,
                           0.977600,
                           0.978256,
                           0.978903,
                           0.979540,
                           0.980168,
                           0.980785,
                           0.981393,
                           0.981992,
                           0.982580,
                           0.983159,
                           0.983729,
                           0.984288,
                           0.984838,
                           0.985378,
                           0.985909,
                           0.986429,
                           0.986940,
                           0.987441,
                           0.987933,
                           0.988415,
                           0.988886,
                           0.989349,
                           0.989801,
                           0.990244,
                           0.990677,
                           0.991100,
                           0.991513,
                           0.991917,
                           0.992310,
                           0.992694,
                           0.993068,
                           0.993433,
                           0.993787,
                           0.994132,
                           0.994467,
                           0.994792,
                           0.995107,
                           0.995413,
                           0.995709,
                           0.995994,
                           0.996270,
                           0.996537,
                           0.996793,
                           0.997039,
                           0.997276,
                           0.997503,
                           0.997720,
                           0.997927,
                           0.998124,
                           0.998312,
                           0.998489,
                           0.998657,
                           0.998815,
                           0.998963,
                           0.999101,
                           0.999229,
                           0.999347,
                           0.999456,
                           0.999555,
                           0.999643,
                           0.999722,
                           0.999792,
                           0.999851,
                           0.999900,
                           0.999940,
                           0.999969,
                           0.999989,
                           0.999999,
                          };

#endif